
# ‚öñÔ∏è Legal Case & Calendar Sync System (Hybrid Edition)

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô‡∏Ñ‡∏î‡∏µ (Internal API) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á **Google Calendar** ‡πÅ‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö Frontend ‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö **Admin Panel** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

![Project Status](https://img.shields.io/badge/Status-Active-success)
![Node.js](https://img.shields.io/badge/Node.js-v14+-green)
![Express](https://img.shields.io/badge/Express-EJS-blue)
![Security](https://img.shields.io/badge/Auth-Cookie%20%26%20OAuth2-red)

## ‚ú® ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏î‡πà‡∏ô (Key Features)

### üöÄ Hybrid Configuration
* **Performance:** ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏î‡∏µ (API URL, User, Pass) ‡∏ú‡πà‡∏≤‡∏ô **`.env`** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß
* **Flexibility:** ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Token Telegram ‡πÅ‡∏•‡∏∞ URL ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ú‡πà‡∏≤‡∏ô **Google Sheets** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô
* **Whitelist:** ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô Google Sheets (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î)

### üõ°Ô∏è Admin Control Panel
* **Secure Access:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô 2 ‡∏ä‡∏±‡πâ‡∏ô (Google OAuth + Signed Cookies) ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤ Admin
* **Manual Sync:** ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á/‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (1, 7, 30, 60 ‡∏ß‡∏±‡∏ô) ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
* **Notification Trigger:** ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô "‡∏Ñ‡∏î‡∏µ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ" ‡πÄ‡∏Ç‡πâ‡∏≤ Telegram ‡πÅ‡∏ö‡∏ö Manual

### üìÖ Calendar & Notification
* **Auto Sync:** ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏î‡∏µ‡∏•‡∏á Google Calendar ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥
* **Daily Summary:** ‡∏™‡∏£‡πâ‡∏≤‡∏á Event ‡πÅ‡∏ö‡∏ö All-day ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏î‡∏µ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô
* **Telegram Alert:** ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° User ‡πÅ‡∏•‡∏∞ Admin ‡πÑ‡∏î‡πâ)

---

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Configuration)

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡∏™‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á **‡πÑ‡∏ü‡∏•‡πå .env** ‡πÅ‡∏•‡∏∞ **Google Sheets**

### 1. ‡πÑ‡∏ü‡∏•‡πå `.env` (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏ó‡∏µ‡πà root folder ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```env
# --- Server Config ---
PORT=3000
APP_URL=http://localhost:3000
COOKIE_SECRET=your_super_secret_key_change_me

# --- Google Cloud Service Account ---
GOOGLE_CLIENT_ID=xxxxxxxxxx.apps.googleusercontent.com
GOOGLE_CALENDAR_ID=xxxxxxxxxxx@group.calendar.google.com
GOOGLE_SHEET_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
GOOGLE_CREDENTIALS={"type":"service_account", ... (JSON ‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô) ...}

# --- Case System API (Core Config) ---
API_URL=http://localhost:8089
API_USER=your_api_username
API_PASS=your_api_password
TOKEN= (‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏≠‡∏á)

```

### 2. Google Sheets (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡πà‡∏≠‡∏¢)

‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 3 ‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô (Tabs) ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

#### ‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô: `Config`

| A (Key) | B (Value) | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
| --- | --- | --- |
| **TELEGRAM_TOKEN** | `123456:ABC...` | Token ‡∏ö‡∏≠‡∏ó‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô User ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ |
| **CHAT_ID** | `-100xxxx` | Chat ID ‡∏Å‡∏•‡∏∏‡πà‡∏° User |
| **TELEGRAM_TOKEN_ADMIN** | `654321:XYZ...` | Token ‡∏ö‡∏≠‡∏ó‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Admin (Logs) |
| **CHAT_ID_ADMIN** | `-100yyyy` | Chat ID ‡∏Å‡∏•‡∏∏‡πà‡∏° Admin |
| **APP_URL** | `https://my-app.onrender.com` | URL ‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏£‡∏¥‡∏á (Server) |
| **APP_URL_LOCAL** | `http://localhost:3000` | URL ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Local |

#### ‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô: `Users` (Whitelist)

| A | B |
| --- | --- |
| **Email** | **Name** |
| `admin@court.go.th` | ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö |
| `staff@gmail.com` | ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |

#### ‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô: `Logs`

| A | B | C | D | E | F | G |
| --- | --- | --- | --- | --- | --- | --- |
| **Event ID** | **Action** | **User** | **Summary** | **Start** | **End** | **Timestamp** |

---

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

1. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Libraries**
```bash
npm install

```


2. **‡∏£‡∏±‡∏ô Server**
```bash
npm start
# ‡∏´‡∏£‡∏∑‡∏≠
node app.js

```


3. **‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**
* ‡πÄ‡∏õ‡∏¥‡∏î Browser ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `http://localhost:3000`
* Login ‡∏î‡πâ‡∏ß‡∏¢ Google Account (‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Sheet `Users`)


4. **‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Admin**
* ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Login ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **Admin** ‡∏ö‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ö‡∏≤‡∏£‡πå
* ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô `http://localhost:3000/admin`
* *(‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ï‡πâ‡∏≠‡∏á Login ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ)*


---

## üîó API Endpoints

| Method | Endpoint | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î | Auth |
| --- | --- | --- | --- |
| **GET** | `/` | ‡∏´‡∏ô‡πâ‡∏≤ Dashboard ‡∏´‡∏•‡∏±‡∏Å | - |
| **GET** | `/admin` | ‡∏´‡∏ô‡πâ‡∏≤ Control Panel | **Cookie** |
| **GET** | `/events` | ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô | - |
| **POST** | `/api/google-login` | ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö Cookie | - |
| **GET** | `/sync-cases/:days` | ‡∏™‡∏±‡πà‡∏á Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô) | **Token** |
| **GET** | `/casetoday` | ‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Telegram | **Token** |

---

## üì¶ Tech Stack

* **Backend:** Node.js, Express, Axios, Cookie-Parser
* **Frontend:** EJS, Bootstrap 5, SweetAlert2
* **Database:** Google Sheets (as Config Store & Logger)
* **Auth:** Google OAuth 2.0 + Signed Cookies

---

Developed for Internal Use.
